{% load clean_title %}
<!DOCTYPE html>
<html>

<head>
    <title> {% clean_title title %}</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <a href="{% url 'logout' %}"> <Button> Logout </Button></a>
    <a href="{% url 'employee:employee_add' %}"> <Button> Add Employee </Button></a>
    <a href="{% url 'tailor_management_system:dashboard' %}"> <Button> Dashboard </Button></a>
    <h2>Employees</h2>
    {% for employee in employees %}
    <ul>
        <li>
            <div>
                <a href="{% url 'employee:employee_detail' employee.id%}"></br>Employee:
                    {{ employee.name }}</a></br></br>
                <a href="{% url 'employee:employee_update' employee.id%}"><Button> Update </Button></a></br></br>
                <a href="#" id="{{ employee.id }}"><Button>Delete </Button></a></br></br>
            </div>
        </li>
    </ul>
    <script>
        $(document).ready(function () {
            const url = "{% url 'employee:employee_delete' %}"
            var id = "{{ employee.id }}"
            var intId = parseInt(id)
            const data = { id: intId, csrfmiddlewaretoken: '{{ csrf_token }}', contentType: 'application/json' }
            $('#{{ employee.id }}').click(function () {
                $.post(url, data, function (data, status) {
                    console.log(`${data} and status is ${status}`)
                    location.reload(true)
                })
            })
        })
    </script>
    {% endfor %}
</body>

</html>