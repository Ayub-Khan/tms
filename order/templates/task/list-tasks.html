{% load clean_title %}
<!DOCTYPE html>
<html>

<head>
    <title> {% clean_title title %}</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <a href="{% url 'logout' %}"> <Button> Logout </Button></a>
    <a href="{% url 'order:tasks' %}"> <Button> List Tasks </Button></a>
    <a href="{% url 'tailor_management_system:dashboard' %}"> <Button>Dashboard </Button></a>
    <h2>Tasks</h2>
    {% for task in tasks %}
    <ul>
        <li>
            <div>
                <a href="{% url 'order:task_detail' task.order.id%}">
                    </br>Task: {{ task.description }} - Employee: {{ task.employee_id.name }} - OrderId:
                    {{ task.order.id }}
                </a></br></br>
                <a href="{% url 'order:task_update' task.id%}"><Button> Update </Button></a></br></br>
                <a href="#" id="{{ task.id }}"><Button> Delete</Button></a>
            </div>
        </li>
    </ul>
    <script>
        $(document).ready(function () {
            const url = "{% url 'order:task_delete' %}"
            var id = "{{ task.id }}"
            var intId = parseInt(id)
            const data = { id: intId, csrfmiddlewaretoken: '{{ csrf_token }}', contentType: 'application/json' }
            $('#{{ task.id }}').click(function () {
                $.post(url, data, function (data, status) {
                    console.log(`${data} and status is ${status}`)
                    location.reload(true)
                })
            })
        })
    </script>
    {% endfor %}
</body>

</html>